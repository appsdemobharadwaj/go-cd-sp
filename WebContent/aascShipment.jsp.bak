
<%       
/*==========================================================================+
|  DESCRIPTION                                                              |
|    JSP aascShipConsoleShipment for displaying the Shipment  related       | 
|    information                                                            |
|    Author Renuka Aleti                                                    |
|    Modified Swapna Soni                                                   |
|    Version   1.1                                                          |                                                                            
|    Creation 10/1/2006                                                     |      
|    History SwapnaSoni 13/04/2006 added textfeild for package dimension    |                                     |
|    ------- SwapnaSoni 14/04/2006 added dropdownlist for dimension units   | 
|   -------- SwapnaSoni 17/04/2006 increased the length of dimension        |   
|            textfeild                                                      |
|   -------- SwapnaSoni 18/04/2006 added the code "|| carrierCode=111" for  |
|            getting the FDXG ship method in the shipMethod drop down list  |
|   ------- SwapnaSoni 19/04/2006 modified the code of dimension units and 
|           added the code for mail link.
|    ------Gayaz Ahamed  Added all the changes with which the adhoc page look 
|          like main page
            Madhavi    04/03/08 Changed page look for Sigsauer
            Madhavi    20/03/08 Modified code for displaying default printer name
            Madhavi    01/05/08 Removed hardcoded value of orgId in call to getShipFromAddr()
            Sambit     10/06/08 Added code for international shipments for fedex.
            Sambit     20/06/08 Added code to store default carrier profile option from session.
            Madhavi    10/06/09 Modified logging code
            Madhavi    23/06/09 Added code for fedex published charges
            Madhavi    13/08/29 Modified code for action not to be submitted for Add,Delete and Clear buttons after Ship
            Gayaz      06/10/09 Added value for options field for customer name
            PavanJ     13/10/10 Added code to enable or disable template based on carrier code
            Bhanu      07/02/10 Modified code to get shipmethod from ShipMethodFromAlt
            Madhavi    19/02/10 Added code to display customer name in error and warning case
            Madhavi    26/08/10 Modified code to display shipper name from Profile options and make it readonly
            23/09/2010  Narasimha E    Added code related to adhocacctPostalCode and countryValidate()
            29/10/2010  Narasimha E    Added hidden variable for storing the shipper name value. 
            06/12/2010  Narasimha E    Modified code to fix the bug tracker issues(After shipping the delivery,carrier a/c not showing,always showing the pay method as prepaid
            26/08/2012 Shaik Khaja   Merged Browser compatability code to SC v6.5
            05/02/2013   Jagadish R Jain  Added code to include ShipPrint functionality in AdhocShipments(print labels along with ship as per profile options)
            05/02/2013   Vijay G  Added code to include Weighing scale code
            07/02/2013   Tina Soni   Added code to integrate hazmat Op900 Label generation functionality.
			      20/02/2013   Ravi Teja   Added jQuery code to implement Auto Complete functionality for Customer Name drop down
            26/09/2013   Sanjay Parui Modified view label link
            10/11/2014   Eshwari    Added this file from cloud 1.2 version
+===========================================================================*/%>

<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core_rt"%>
<%@ taglib uri="/struts-tags" prefix="s"%>
<%@ page contentType="text/html;charset=windows-1252" isELIgnored="false"%>
<%@page import="java.util.logging.*"%>
<%@page import="java.util.*" %>
<%@page import="java.sql.*"%>
<%@page import="com.aasc.erp.model.*"%>
<%@ page import="com.aasc.erp.bean.*"%>
<%@page import="com.aasc.erp.util.*"%>
<%@page import="oracle.jdbc.driver.*"%>
<%@page import="com.aasc.erp.carrier.*" %> 
<%@ page errorPage="aascShipError.jsp"%>
<%! private static Logger logger=AascLogger.getLogger("aascShipment"); %>
<html>
  <head>
    <title>ShipConsole :: Shipping</title>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9"></meta>
    <style type="text/css"> 
.back
{
width:95%;
border:2px solid #a1a1a1;
padding:5px 5px; 

border-radius:25px;
-moz-border-radius:25px;
-webkit-border-radius:25px;

box-shadow: 10px 10px 5px #888888;
-moz-box-shadow: 10px 10px 5px #888888;
-webkit-box-shadow: 10px 10px 5px #888888;
   /* box-shadow: 3px 3px 4px #ccc;  For IE 8 */
    -ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#cccccc')"; /* For IE 5.5 - 7 */
    filter: progid:DXImageTransform.Microsoft.Shadow(Strength = 10, Direction = 135, Color = '#888888');
    

background:#FAFAFA;  /*dddddd*/ /* for non-css3 browsers */
	
        

}
</style>
    <link type="text/css" rel="stylesheet" href="jquery-ui.css"/>
    <link type="text/css" rel="stylesheet" href="aasc_ss.css"/>
    <script language="JavaScript" src="aasc_Shipment_JS.js"></script>
    <script language="JavaScript" src="jquery-1.8.3.js"></script>
    <script language="JavaScript" src="jquery-ui.js"></script>
    <script>
 
  
(function( $ ) {
    $.widget( "ui.combobox", {
      _create: function() {
        var input,
          that = this,
          wasOpen = false,
          select = this.element.hide(),
          selected = select.children( ":selected" ),
          value = selected.val() ? selected.text() : "",
          wrapper = this.wrapper = $( "<span>" )
          //  .addClass( "ui-combobox" )
            .insertAfter( select );
      
        function removeIfInvalid( element ) {
          
          document.DynaShipmentShipSaveForm.customerName.options[document.DynaShipmentShipSaveForm.customerName.selectedIndex].value=$( element ).val();
          document.DynaShipmentShipSaveForm.shipFromLoc.options[document.DynaShipmentShipSaveForm.shipFromLoc.selectedIndex].value=$( element ).val();
          var value = $( element ).val(),
            matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( value ) + "$", "i" ),
            valid = false;
          select.children( "option" ).each(function() {
            if ( $( this ).text().match( matcher ) ) {
              this.selected = valid = true;
              return false;
            }
          });
 
          if ( !valid ) {
            // remove invalid value, as it didn't match anything
            $( element )
            //  .val( "" )
            //  .attr( "title", value + " didn't match any item" )
            //  .tooltip( "open" );
           // select.val( "" );
//            setTimeout(function() {
//             // input.tooltip( "close" ).attr( "title", "" );
//            }, 2500 );
          input.data( "ui-autocomplete" ).term = "";
          }
        }
     
        input = $( "<input>" )
          .appendTo( wrapper )
          .val( value )
          .attr( "title", "" )
          .attr("id",read())
        //  .addClass( "ui-state-default ui-combobox-input" )
          .autocomplete({
            delay: 0,
            minLength: 0,
            source: function( request, response ) {
              var matcher = new RegExp("^" +$.ui.autocomplete.escapeRegex(request.term), "i" );
              response( select.children( "option" ).map(function() {
             
                var text = $( this ).text();
                if ( this.value && ( !request.term || matcher.test(text) ) )
                  return {
                    label: text.replace(
                      new RegExp(
                        "(?![^&;]+;)(?!<[^<>]*)(" +
                        $.ui.autocomplete.escapeRegex(request.term) +
                        ")(?![^<>]*>)(?![^&;]+;)", "gi"
                      ), "<strong>$1</strong> "),
 value: text, option: this }; }) ); }, select: function( event, ui
    ) { ui.item.option.selected = true; that._trigger( "selected",
    event, { item: ui.item.option }); //Gururaj added below code to bug fix 1924
    var
    customername=document.DynaShipmentShipSaveForm.customerName.options[document.DynaShipmentShipSaveForm.customerName.selectedIndex].value;
    var
    shipFromLoc=document.DynaShipmentShipSaveForm.shipFromLoc.options[document.DynaShipmentShipSaveForm.shipFromLoc.selectedIndex].value;
    var customerNameOptionsArray= new Array(); var customerNameOptions =
    document.getElementById('customerName'); 
    for (i = 1; i &lt; customerNameOptions.options.length; i++) 
    { customerNameOptionsArray[i] =
    customerNameOptions .options[i].value;
    if(customername==customerNameOptionsArray[i]) { getShipToAddr1(); } } var
    shipFromLocOptionsArray= new Array(); shipFromLocOptions =
    document.getElementById('shipFromLoc'); for (i = 1; i &lt;
    shipFromLocOptions.options.length; i++) { shipFromLocOptionsArray[i] =
    shipFromLocOptions.options[i].value;
    if(shipFromLoc==shipFromLocOptionsArray[i]) { getShipFromAddress(); } }
    //Gururaj code end }, change: function( event, ui ) { if ( !ui.item ) {
    removeIfInvalid( this ); } } }) .addClass( &";ui-widget ui-widget-content
    ui-corner-left&"; ); input.data( &";ui-autocomplete&";
    )._renderItem = function( ul, item ) { return $( &";
  </head>
  <li>
    " ) .append( "
    <a>" + item.label + "</a>
    "; ) .appendTo( ul ); }; $( ";
    <a>
      &"; ) .attr( &";tabIndex&";, -1 ) // .attr( &";title&";,
      &";Show All Items&"; ) // .tooltip() .appendTo( wrapper ) .button({
      icons: { primary: &";ui-icon-triangle-1-s&"; }, text: false })
      .removeClass( &";ui-corner-all&"; ) .addClass( &";ui-corner-right
      ui-combobox-toggle&"; ) .mousedown(function() { wasOpen =
      input.autocomplete( &";widget&"; ).is( &";:visible&"; ); })
      .click(function() { input.focus(); // close if already visible if (
      wasOpen ) { return; } // pass empty string as value to search for,
      displaying all results input.autocomplete( &";search&";, &";&";
      ); }); input.tooltip({ tooltipClass: &";ui-state-highlight&"; }); },
      _destroy: function() { this.wrapper.remove(); this.element.show(); } });
      })( jQuery ); $(function() { $( &";#customerName&"; ).combobox(); $(
      &";#toggle&"; ).click(function() { $( &";#customerName&";
      ).toggle(); }); }); $(function() { $( &";#shipFromLoc&";
      ).combobox(); $( &";#toggle&"; ).click(function() { $(
      &";#shipFromLoc&"; ).toggle(); }); }); function changePassword(){
      tpwindow =
      window.open(&";aascChangePassword.jsp&";,&";Post&";,'width=500,height=350,top=100,left=100,scrollbars=yes,
      resizable=yes'); tpwindow.focus(); } function editProfile(){ tpwindow =
      window.open(&";aascEditUserProfile.jsp&";,&";Post&";,'width=700,height=450,top=100,left=100,scrollbars=yes,
      resizable=yes'); tpwindow.focus(); } $(function() {
      $(&";.dropdown&";).hover( function() {
      $(&";.submenu&";).slideToggle(400); }, function() {
      $(&";.submenu&";).hide(); } ); });
      <!-- Suman Added code for clear funcationality        -->
      var a=1; function read(){ if(a==1){ a=2; return 'shipToId';} else{ a=1;
      return 'shipFromId';} }</script>
      <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
      <style type="text/css">
<!--
.style6 {color: #003399}
-->
    </style>
      <%! 
   /**
  * nullStringToSpace() method is used when the string is null it replaces with space.
  * @param object of type Object
  * @return object of type String.
  */  
  public String nullStringToSpace(Object object) {
    String spcStr = "";
    if (object == null) {
      return spcStr;
    }
    else {
      return object.toString();
    }
  }    
%>
      <%  
  int clientIdInt=-1;
  try {  %>
      <body bgcolor="#0CA3D2" onload="fill();focus();load();">
      <div class="wrapper" style="width:98%;">
          <s:set name="aascShipmentOrderInfo" value="%{#session.AascShipmentOrderInfo}"/>
          <s:set name="aascShipmentHeaderInfo" value="%{#aascShipmentOrderInfo.ShipmentHeaderInfo}"/>
          <s:set name="Sflag" value="%{#aascShipmentHeaderInfo.saturdayShipFlag}"/>
          <s:set name="ShipmentShipFromList" value="%{#session.locationDetailsList}"/>
          <progressbar id="progressbar" value="33"/>
          <%   
   AascShipMethodInfo aascShipMethodInfo=null;   
   ListIterator shipMethodIterator=null;
   AascShipmentFlags ShipmentFlags=null;
   try
  {
   aascShipMethodInfo=(AascShipMethodInfo)session.getAttribute("ShipMethodInfo");
   logger.info("the value is ShipMethodInfo"+aascShipMethodInfo);
   /*if(aascShipMethodInfo==null){
     aascShipMethodInfo=new AascShipMethodInfo() ; 
   }  */
   shipMethodIterator=(aascShipMethodInfo.getDropOffTypeList()).listIterator();   
   AascShipmentHeaderInfo aascShipmentHeaderInfo=(AascShipmentHeaderInfo)request.getAttribute("aascShipmentHeaderInfo");
   ShipmentFlags=new AascShipmentFlags(aascShipmentHeaderInfo);
   logger.info("ShipmentFlags value in the shipment jsp="+ShipmentFlags);   
}
  catch(Exception e)
  {
    //e.printStackTrace();
    logger.info("inside exception");
    logger.severe("exception in aascShipment.jsp while creating object"+e.getMessage());
  }
  
  // Weighing Scale Code
  int userId1=((Integer)session.getAttribute("user_id")).intValue();
  logger.info("userId1 : "+userId1);
  int responsibilityId1= ((Integer)session.getAttribute("role_id")).intValue();
  int locationID1=((Integer)session.getAttribute("location_id")).intValue();
  //String schemaName = AascProps.getSchemaName();
  AascDBAccess aascDBaccess= new AascDBAccess();
  clientIdInt=(Integer)session.getAttribute("client_id");
  String clientId = ""+clientIdInt;
     
  try
  {
      String testclientId=clientId.substring(0,1);
  }
  catch(Exception e)
  {
     logger.info("inside exception eeee ");
     clientIdInt=(Integer)session.getAttribute("client_id");
  }
  
/*String[] weightClassDetails=aascDBaccess.getWeighingScaleName(locationID1,clientIdInt,userId1);
String weightClass = weightClassDetails[0];
String vendorId = weightClassDetails[1];
String productId1 = weightClassDetails[2];
String productId2 = weightClassDetails[3];
String wsTopology = weightClassDetails[4];

pageContext.setAttribute("weightClass",weightClass);
pageContext.setAttribute("vendorId",vendorId);
pageContext.setAttribute("productId1",productId1);
pageContext.setAttribute("productId2",productId2);
pageContext.setAttribute("wsTopology",wsTopology);
*/
%>
           
<script language="javascript">
var CarrierCodeDropOffA=new Array();
var DropOfftypeA=new Array();
var PackagingA=new Array();
var CarrierCodePackagingA=new Array();
var DropOflength = 0;
var PackagingLenth = 0;
function fillFedex()
  {
   <%  try{
   int methodCount =0; 
   while(shipMethodIterator.hasNext())
   {  
      AascShipMethodInfo aascShipMethodInfo2=(AascShipMethodInfo)shipMethodIterator.next(); 
      
   %>DropOfftypeA[<%=methodCount%>]="<%=aascShipMethodInfo2.getDropOffType()%>";<%
		     %>CarrierCodeDropOffA[<%=methodCount%>]="<%=aascShipMethodInfo2.getCarrierCode()%>";<%
         methodCount++;
         
    }  
   %>DropOflength="<%=methodCount%>";<%
   
    methodCount =0; 
    shipMethodIterator=(aascShipMethodInfo.getPackagingList()).listIterator();
   while(shipMethodIterator.hasNext())
  {  
     AascShipMethodInfo aascShipMethodBean= (AascShipMethodInfo)shipMethodIterator.next(); 
       %>PackagingA[<%=methodCount%>]="<%=aascShipMethodBean.getPackaging()%>";<%
		     %>CarrierCodePackagingA[<%=methodCount%>]="<%=aascShipMethodBean.getCarrierCode()%>";<%
         methodCount++;
         
    }  
   %>PackagingLenth="<%=methodCount%>";<%    
    }
 catch(Exception e)
    {
   logger.log(Level.SEVERE,"Exception in ship method",e);   
    }
    %>
  }
  </script><%}
 catch(Exception e)
    {
   logger.log(Level.SEVERE,"Exception in ship method",e);   
    }
    
%>
           
<s:bean id="aascShipMethodInfo" name="com.aasc.erp.bean.AascShipMethodInfo"/>
<s:bean id="carrierPayMethod" name="java.util.LinkedList"/>
<s:bean id="aascPrinterInfo" name="com.aasc.erp.bean.AascPrinterInfo"/>

<s:bean id="aascTemplateInfo" name="com.aasc.erp.bean.AascTemplateInfo"/>          
<s:bean id="aascShipmentOrderInfo" name="com.aasc.erp.bean.AascShipmentOrderInfo"/>
<s:bean id="aascShipmentHeaderInfo" name="com.aasc.erp.bean.AascShipmentHeaderInfo"/>

<s:bean id="aascShipmentPackageInfo" name="com.aasc.erp.bean.AascShipmentPackageInfo"/>
<s:bean id="shipMethodList" name="java.util.LinkedList"/>
<s:bean id="templateList" name="java.util.LinkedList"/>
<s:set name="carrierPayMethodHide" value="%{''}"/>
<s:set name="shipMethodHidden1" value="%{''}"/>
<s:set name="serialNumber" value="%{1}"/>

<s:set name="carrierAccountNumber" value="%{''}"/>
<s:set name="shipMethod1" value="%{''}"/>
<s:set name="error" value="%{''}"/>
<s:set name="carrierId" value="%{0}"/>
<s:set name="carrierCode" value="%{0}"/>
<s:set name="shipMethodValidation" value="%{''}"/>
           
<s:set name="carrierProfileOptionsShipmethod" value="%{''}"/>
<s:set name="ProfileDropOffType" value="%{''}"/>
<s:set name="ProfileCarrierPaymethod" value="%{''}"/>
<s:set name="ProfileCarrierPackaging" value="%{''}"/>
<s:set name="sigOptions" value="%{''}"/>
<s:set name="CODFlag" value="%{''}"/>

<s:set name="ReturnFlag" value="%{''}"/>
<s:set name="CODFundsCode" value="%{''}"/>
<s:set name="CODCurrCode" value="%{''}"/>
<s:set name="CODType" value="%{''}"/>
<s:set name="halLine1" value="%{''}"/>
<s:set name="ProfileHazmatFlag" value="%{''}"/>
           
<%         
  AascShipmentFlags ShipmentFlags=null;
  
  String url = request.getContextPath();
  
  // Added to pull UPS mode from Carrier configuration instead of ProfileOption page
  AascShipMethodInfo aascShipMethodInfoUPS=(AascShipMethodInfo)session.getAttribute("ShipMethodInfo");        
  //logger.info("");
  int carrierIdUPS = aascShipMethodInfoUPS.getCarrierIdFromCarrierCode(100);
  //logger.info("carrierIdUPS********"+carrierIdUPS);
  String connectionModeUPS = aascShipMethodInfoUPS.getCarrierMode(carrierIdUPS);
  //logger.info("connectionModeUPS***************"+connectionModeUPS);
  pageContext.setAttribute("connectionModeUPS",connectionModeUPS);          
 %>
             
    <s:set name="connectionModeUPS" value="%{#attr.connectionModeUPS}"/>
    <s:set name="aascProfileOptionsInfo" value="%{#session.ProfileOptionsInfo}"/>
    <s:hidden name="internationalFlag" id="internationalFlagId" value="%{#aascProfileOptionsInfo.international}"/>
    <s:set name="defaultCarrierSessionValuesFlag" value="%{''}"/>
    <s:set name="defaultCarrierSessionValuesFlag" value="%{#aascProfileOptionsInfo.defaultCarrierSessionValuesFlag}"/>
             
    <s:if test="%{#defaultCarrierSessionValuesFlag == null}">
    <s:set name="defaultCarrierSessionValuesFlag" value="%{''}"/>
  </s:if>
           
  <s:if test='%{#defaultCarrierSessionValuesFlag == "Y"}'>
     <s:set name="aascCarrierProfileOptionsInfo" value="%{#session.CarrierProfileOptionsInfo}"/>
  </s:if>
           
  <s:set name="flag" value="%{0}"/>
  <s:set name="shipError" value="%{''}"/>
  <s:set name="errorDesc" value="%{''}"/>
           
  <s:set name="ShipmentWarningStatus" value="%{''}"/>
  <s:set name="HALFlag" value="%{''}"/>
           
  <%  
  if(session.isNew())
  {
   response.sendRedirect(url+"/aascShipError.jsp");
  }
  %>
           
  <c:catch var="exception">
    <s:set name="aascShipMethodInfo" value="%{#session.ShipMethodInfo}"/>
    <s:set name="carrierPayMethod" value="%{#aascShipMethodInfo.carrierPayDetails}"/>
    <s:set name="aascPrinterInfo" value="%{#session.PrinterInfo}"/>
    <s:set name="aascTemplateInfo" value="%{#session.TemplateList}"/>
    <s:set name="aascShipmentOrderInfo" value="%{#session.AascShipmentOrderInfo}"/>
    <s:set name="aascShipmentHeaderInfo" value="%{#aascShipmentOrderInfo.ShipmentHeaderInfo}"/>
    <s:set name="templateList" value="%{#aascTemplateInfo.templateList}"/>
    <s:set name="templateListTmp" value="%{#templateList}" scope="page"/>
  </c:catch>
           
  <s:if test="%{#exception != null}">
       <c:redirect url="/aascShipError.jsp"/>
  </s:if>
           
  <%
   String error=(String)request.getAttribute("error");
   AascShipMethodInfo aascShipMethodInfo=null;
   AascShipmentOrderInfo aascShipmentOrderInfo=null;
   AascShipmentHeaderInfo aascShipmentHeaderInfo=null;
   ListIterator shipMethodIterator=null;
   String shipMethodValidation="";
   LinkedList carrierPayMethod=null;
   ListIterator carrierPayMethodIterator=null;
   AascTemplateInfo aascTemplateInfo=null;
   AascPrinterInfo aascPrinterInfo=null;
   LinkedList printerList=null;
   ListIterator printerIterator=null;
   AascShipMethodInfo aascShipMethodInfoForTemplate=null;
   LinkedList templateList=null;
   ListIterator templateIterator=null;
   int packCount=0;
  
   String voidFlagDisable="";
   try
   {
     /*aascTemplateInfo=(AascTemplateInfo)session.getAttribute("TemplateList");
     logger.info("aascTemplateInfo : "+aascTemplateInfo);
     templateList=aascTemplateInfo.getTemplateList();
     templateIterator=templateList.listIterator();  */
   
     aascShipMethodInfo=(AascShipMethodInfo)session.getAttribute("ShipMethodInfo");
     shipMethodIterator=(aascShipMethodInfo.getShipMethodDetailList()).listIterator();
    
     carrierPayMethod=aascShipMethodInfo.getCarrierPayDetails();
     carrierPayMethodIterator=carrierPayMethod.listIterator();
 
     aascShipmentOrderInfo=(AascShipmentOrderInfo)session.getAttribute("AascShipmentOrderInfo");
     aascShipmentHeaderInfo=aascShipmentOrderInfo.getShipmentHeaderInfo();
     
     //logger.info("aascShipmentHeaderInfo : "+aascShipmentHeaderInfo);  
     aascPrinterInfo=(AascPrinterInfo)session.getAttribute("PrinterInfo");
     if(aascPrinterInfo != null)
       printerList=aascPrinterInfo.getPrinterList();
     else
       printerList = new LinkedList();
     printerIterator=printerList.listIterator();
  
     aascShipMethodInfoForTemplate=(AascShipMethodInfo)session.getAttribute("ShipMethodInfo");
     logger.info("printerIterator : "+printerIterator);  
     if(aascShipmentHeaderInfo == null){
       ShipmentFlags = new AascShipmentFlags(new AascShipmentHeaderInfo());
     }else{
       ShipmentFlags=new AascShipmentFlags(aascShipmentHeaderInfo);
     }
   }
   catch(Exception e)
   {
     logger.severe("exception while creating the objects in the Shipment jsp"+e.getMessage());
     response.sendRedirect(url+"/aascShipError.jsp");
     e.printStackTrace();
   }
  %>
  <s:set name="packageList" value="%{#aascShipmentOrderInfo.ShipmentPackageInfo}"/>
           
  <s:if test="%{#packageList == null}">
     <s:bean name="java.util.LinkedList" id="packageList"/>
  </s:if>
           
  <s:if test="%{#attr.key1 != null}">
    <s:set name="first" value="%{'DISABLED'}" scope="session"/>
  </s:if>
         
  <s:set name="firstDisable" value="%{''}"/>
   
  <c:catch var="ex">
    <s:set name="ProfileOptionsInfo" value="%{#session.ProfileOptionsInfo}"/>
  </c:catch>
   
  <c:if test="${ex!= null}">
    <c:out value="Exception Message while setting values at the start are: ${ex}"/>
  </c:if>
   
          <script>
 var TemplateName=new Array();
 var PrinterName=new Array();
 var ShipMethod=new Array();
 
 function fill()
 {
 	<%
    try
    {
   
      int i1 =0;
      logger.info("templateIterator : "+templateIterator);
      if(templateIterator != null)
      {
      while(templateIterator.hasNext())
      {
         AascTemplateInfo aascTemplateInfo1 = (AascTemplateInfo) templateIterator.next();
         %>TemplateName[<%=i1%>]="<%=aascTemplateInfo1.getTemplateName()%>";<%
                     %>PrinterName[<%=i1%>]="<%=aascTemplateInfo1.getPrinterName()%>";<%
         i1++;
      }
      }
    }
    catch(Exception e)
    {
        logger.severe("exception in the fill() method in the Shipment jsp"+e.getMessage());
        response.sendRedirect(url+"/aascShipError.jsp");
        e.printStackTrace();
    }
 %>
 //FillCarrier();
 
}
</script><!--%! 
   /**
  * nullStringToSpace() method is used when the string is null it replaces with space.
  * @param object of type Object
  * @return object of type String.
  */  
  public String nullStringToSpace(Object object) {
    String spcStr = "";
    if (object == null) {
      return spcStr;
    }
    else {
      return object.toString();
    }
  }    
  %--><% 
  try
  {
  %>
  
  <table width="100%" cellpadding="0" cellspacing="0">  
    <tr>
      <td width="100%" height="100" align="left" valign="top">
      <div align="left">
      <table width="100%" height="100%" border="0" align="left" cellpadding="0" cellspacing="0"> 
        <tr valign="top">
          <td>
            <table width="100%">
              <tr>
                <td height="54" colspan="6">
                    <%@ include file="aascHeader.jsp"%>
                </td> 
              </tr>
            </table>
          </td>
        </tr>
        <tr align="center" valign="top">
          <td colspan="3" style="border: 0px; border-collapse: collapse;">
            <s:form name="ShipGetForm" id="ShipGetFormId" method="POST" action="ShipmentOrderInfoAction"
                    onsubmit="return orderNumberValid()">
              <table cellspacing="0" cellpadding="0" border="0" width="100%">
                <tr>
                  <td width="25%" height="34" align="center" nowrap="nowrap"> 
                    <div align="left" class="pageHeading"> <s:property value="getText('ShipmentOrders')"/> </div> </td>
                  <td width="50%" align="center" nowrap="nowrap"> <div align="left"> <span class="dispalyFields"><s:property value="getText('PleaseenteraOrderNumber')"/>.</span>
                      <s:textfield name="orderNumber" id="orderNumberId" cssClass="inputFields" value="%{''}"/>
                      <s:hidden name="submit" value="%{''}"/>
                       
                      <s:hidden name="shipError" value="%{#shipError}"/>
                       
                      <s:hidden name="errorDesc" value="%{#errorDesc}"/>
                             
                      <input name="submit11" type="image" id="GoButton" onClick="submit.value='Go'"; value="Go" src="buttons/aascGo1.png" alt="[submit]" align="middle"></input>
                      </div></td>
                  <td> <div align="center">
                    <!--<input name="submitButton" type="submit" class="inputFields" id="newOrder" onClick="shipButtonValueNull()" value=" New Order  " /> -->
                                   
                    <a href="#"><img name="submit11" id="newOrderId" src="buttons/aascNewOrder1.png" onclick="ShipGetForm.submit.value='NewOrder';return orderNumberValid()" border="0"/> </a> </div>
                  </td>
                  <td> <div align="center">
                      <!-- <input name="clear" type="RESET" class="inputFields" value="      Clear       "  <//%=nullStringToSpace(ShipmentFlags.getClearDisableFlag())%>/> -->
                      <% 
                         String readOnlyFlag=ShipmentFlags.getReadOnlyFlag();
                       
                         pageContext.setAttribute("readOnlyFlag",readOnlyFlag);
                         pageContext.setAttribute("ShipmentFlags",ShipmentFlags);
           
                      %>
                      <s:set name="ShipmentFlags" value="%{#attr.ShipmentFlags}"/>
                      <s:if test='%{#ShipmentFlags.clearDisableFlag == "DISABLED"}'>
                        <!-- Gururaj modified below code for bug fix #2216-->
                        <img src="buttons/aascShipmentClearOff1.png" name="reset" id="resetDisableId" align="middle" onclick="ShipGetForm.submit.value='Clear';formReset()"/>
                        <!-- Gururaj code end -->
                      </s:if>
                      <s:else>
                        <input name="reset" type="hidden" value=""/>
                        <!-- Gururaj modified below code for bug fix #2216-->
                        <input name="reset" id="resetEnableId" type="image" src="buttons/aascShipmentClear1.png" onclick="ShipGetForm.submit.value='Clear';formReset()" value=""/>
                        <!-- Gururaj code end -->
                      </s:else>
                      </div>
                   </td>
                </tr>
              </table>
            </s:form>  
          </td>
        </tr>
             
        <tr align="left" valign="top">
        <s:form method="POST" action="ShipmentOrderShipSaveAction" name="DynaShipmentShipSaveForm" id="DynaShipmentShipSaveForm" onsubmit="return validation();">
          <input type="hidden" name="clientIdHid" id="clientIdHid" value="<%=clientIdInt%>"/>
          <s:hidden name="wsTopologyInMain" value="%{#wsTopologyInMain}"/>
          <s:hidden name="vendorId" value="%{#vendorIdInMain}"/>
          <s:hidden name="productId1" value="%{#productId1InMain}"/>
          <s:hidden name="productId2" value="%{#productId2InMain}"/>
          <s:hidden name="InvVal" value="%{}"/>
          <s:hidden name="submitButton1" value="%{0}"/>
          <s:hidden name="submitButton" id="submitButtonId" value="%{''}"/>
          <s:hidden name="actionType" value="%{#shipSave}"/>
          <s:hidden name="upsMode" id="upsMode" value="%{#connectionModeUPS}"/>
          <s:hidden name="voidStatusFlag" id="voidStatusFlagId" value="%{''}"/>
          <!--html:form name="ShipInsertForm" method="POST" action="/ShipmentOrderShipSaveAction.do" type="org.apache.struts.action.DynaActionForm" onsubmit="return validation()"-->
        
          <td colspan="3" style="border: 0px; border-collapse: collapse;">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="100%" style="border: 0px; border-collapse: collapse;">
                  <table width="100%" cellpadding="0" cellspacing="10" class="tableDataCell">
                    <%
                    AascDAOFactory aascDAOFactory = AascDAOFactory.getAascDAOFactory(1);
                    AascShipmentOrderInfoDAO aascShipmentOrderInfoDAO = null;
                    aascShipmentOrderInfoDAO = aascDAOFactory.getAascShipmentOrderInfoDAO();
                    
                    int orderNo = 0;
                    if(aascShipmentHeaderInfo.getShipFlag().equalsIgnoreCase("N") && aascShipmentHeaderInfo.getPreviousOrderNumber() != 0){
                     orderNo=aascShipmentHeaderInfo.getPreviousOrderNumber();
                     aascShipmentHeaderInfo.setOrderNumber(orderNo);
                    }
                    else if(aascShipmentHeaderInfo.getShipFlag().equalsIgnoreCase("N") && error.equalsIgnoreCase("") )
                    {
                      logger.info("ShipFlag is N");
                      aascShipmentOrderInfoDAO = aascDAOFactory.getAascShipmentOrderInfoDAO();
                      orderNo = aascShipmentOrderInfoDAO.getOrderNumber(clientIdInt);
                      aascShipmentHeaderInfo.setOrderNumber(orderNo);
                    }
                    if(orderNo != 0){
                      session.setAttribute("orderNoTmp",orderNo);
                    }
                    session.removeAttribute("shipment");
                    String shipment = "Shipment";
                    session.setAttribute("shipment",shipment);
                    pageContext.setAttribute("aascShipmentHeaderInfo",aascShipmentHeaderInfo);
           
                    // end in 09/06/08                     
                    %>
                    <tr>
                      <td align="left" valign="top" style="FONT-WEIGHT: bold;FONT-SIZE: 11px;FONT-FAMILY: Tahoma;color: white;">
                        <s:property value="getText('OrderNumber')"/>
                        <s:set name="aascShipmentHeaderInfo"  value="%{#attr.aascShipmentHeaderInfo}"/>
                        <s:hidden cssClass="dispalyDBFields" name="orderNum" value="%{#aascShipmentHeaderInfo.orderNumber}"/>
                        <s:property value="%{#aascShipmentHeaderInfo.orderNumber}"/>
                      </td>
                      <td colspan="2" align="left" valign="top"    style="FONT-WEIGHT: bold;FONT-SIZE: 11px;FONT-FAMILY: Tahoma;color: white;">
                        <div align="center">
                          <s:if test='%{#aascShipmentHeaderInfo.shipFlag == "Y" || #aascShipmentHeaderInfo.shipFlag == "y"}'>
                            <img src="aasc_tick.gif" width="16" height="16"/>
                            <span class="displayMessage1" style="color:white;"> <s:property value="getText('Shipped')"/> </span>
                          </s:if>
                           &nbsp;&nbsp; 
                          <s:if test='%{#aascShipmentHeaderInfo.printLabelFlag == "Y" || #aascShipmentHeaderInfo.printLabelFlag == "y"}'>
                            <img src="aasc_tick.gif" width="16" height="16"/>
                            <span class="displayMessage1" style="color:white;"> <s:property value="getText('LabelsPrinted')"/> </span>
                          
                          </s:if>
                           
                          <span id="tickPic"></span>
                                 &nbsp;&nbsp; 
                          <span class="displayMessage" id="intlMassage">
                          </span>
                          </div>
                      </td>
                    </tr>
                    <tr>
                      <td width="15%" height="35%" valign="top">
                        <table width="100%" height="100%" class="back">
                          <tr>
                            <td valign="top" align="center" colspan="2" class="headings"><s:property value="getText('ShipFrom')"/></td>
                          </tr>
                          <tr align="left" valign="top">
                            <td class="dispalyFields" nowrap="nowrap">  <s:property value="getText('CompanyName')"/>
                            </td>
                            <td>
                              <!--   <s:textfield name="shipFromOrg"  cssClass="inputFields"  id="shipFromOrg"  value="%{#ShipmentFlags.readOnlyFlag}"/>-->
                              <%
                                try{
                              %>
                              <div class="ui-widget" id="ui-widgetShipFromId">
                               <%
                                  StringTokenizer strToken=new StringTokenizer(nullStringToSpace(aascShipmentHeaderInfo.getShipFromLocation()),"****");
                                  String trimmedShipFromLoc="";
                                  while (strToken.hasMoreElements()) {
                                     trimmedShipFromLoc=strToken.nextElement().toString();
                                     // logger.info("Trimmed SHipFromLocation"+trimmedShipFromLoc);
                                     break;
                                  }
                               %>
                                           
                               <select name="shipFromLoc" id="shipFromLoc" onkeydown="fnKeyDownHandler(this, event);" onkeyup="fnKeyUpHandler_A(this, event); return false;" onkeypress="return fnKeyPressHandler_A(this, event);" onchange="fnChangeHandler_A(this, event);getShipFromAddress()" cssclass="inputFields" <%=nullStringToSpace(ShipmentFlags.getReadOnlyFlag())%> >
                               <%
                                  if(ShipmentFlags.getSelectDisableFlag().equalsIgnoreCase("DISABLED") )
                                  {
                               %>
                                  <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getShipFromLocation())%>">
                                    <%=nullStringToSpace(trimmedShipFromLoc)%>
                                  </option>
                               <% }
                                  else{
                               %>
                                  <option></option>
                               <%
                                    int count=0;
                                    LinkedList shipFromList1=(LinkedList)session.getAttribute("locationDetailsList");
                                    
                                    ListIterator shipFromIterator=null;
                                    shipFromIterator=(shipFromList1).listIterator(); 
                                
                                    while(shipFromIterator.hasNext())
                                    {
                                      AascSetupLocationBean aascSetupLocationBean=(AascSetupLocationBean)shipFromIterator.next();   // Ship From Location
                                      if(!nullStringToSpace(aascShipmentHeaderInfo.getShipFromCompanyName()).equalsIgnoreCase(""))
                                      {
                                        if(!(aascSetupLocationBean.getLocationName()+"****"+aascSetupLocationBean.getLocationId()).equalsIgnoreCase(nullStringToSpace(aascShipmentHeaderInfo.getShipFromLocation())))
                                        {
                                          count++;
                                        }
                                      }
                                      if((aascSetupLocationBean.getLocationName()+"****"+aascSetupLocationBean.getLocationId()).equalsIgnoreCase(nullStringToSpace(aascShipmentHeaderInfo.getShipFromLocation())))
                                      {
                                %>
                                  <option selected="selected" value='<%=(aascSetupLocationBean.getLocationName()+"****"+aascSetupLocationBean.getLocationId())%>'> <%=nullStringToSpace(aascSetupLocationBean.getLocationName())%> </option>
                                <%    }else
                                      {
                                %>
                                  <option value='<%=(aascSetupLocationBean.getLocationName()+"****"+aascSetupLocationBean.getLocationId())%>'> <%=nullStringToSpace(aascSetupLocationBean.getLocationName())%> </option>
                                <%
                                      }
                                    }
                                    if(count>0)
                                    {
                                        ////logger.info("Entered if");
                                %>
                                 <option selected="selected" value="<%=nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())%>"> <%=nullStringToSpace(trimmedShipFromLoc)%> </option>
                                <%
                                    }
                                }
                                }                 
                                catch(Exception e)
                                {e.printStackTrace();}           
                              %>
                              </select>
                              </div>
                            </td>
                            <!--Gururaj added code for Ship From Contact Name -->
                          </tr>
                          <tr align="left" valign="top">
                            <td class="dispalyFields"> <s:property value="getText('ContactName')"/> </td>
                            <td>
                               <s:textfield name="shipFromContactName" cssClass="inputFields" id="shipFromContactName" value="%{#aascShipmentHeaderInfo.shipperName}"/>
                            </td>
                          </tr>
                          <!--Gururaj code end-->
                          <tr align="left" valign="top">
                            <td class="dispalyFields"> <s:property value="getText('AddressLine1')"/> </td>
                            <td>
                               <s:textfield name="shipFromAddressLine1" cssClass="inputFields" id="shipFromAddressLine1" value="%{#aascShipmentHeaderInfo.shipFromAddressLine1}"/>
                            </td>
                          </tr>
                          <tr align="left" valign="top">
                            <td class="dispalyFields"> <s:property value="getText('AddressLine2')"/> </td>
                            <td>
                                <s:textfield name="shipFromAddressLine2" cssClass="inputFields" id="shipFromAddressLine2" value="%{#aascShipmentHeaderInfo.shipFromAddressLine2}"/>
                            </td>
                          </tr>
                          <tr align="left" valign="top">
                            <td colspan="2">
                            <table>
                              <tr>
                                <td class="dispalyFields">  <s:property value="getText('City')"/> </td>
                                <td>
                                  <s:textfield name="shipFromCity" cssClass="inputFields" id="shipFromCity" size="10" value="%{#aascShipmentHeaderInfo.shipFromCity}"/>
                                </td>
                                <td class="dispalyFields"> <s:property value="getText('State')"/> </td>
                                <td>
                                  <s:textfield name="shipFromState" cssClass="inputFields" id="shipFromState" size="10" onblur="shipFromStateChgCase()" value="%{#aascShipmentHeaderInfo.shipFromState}"/> </td>
                              </tr>
                              <tr>
                                <td class="dispalyFields"> <s:property value="getText('PostalCode')"/> </td>
                                <td>
                                  <s:textfield name="shipFromPostalCode" cssClass="inputFields" id="shipFromPostalCode" size="10" value="%{#aascShipmentHeaderInfo.shipFromPostalCode}"/> 
                                </td>
                                <td class="dispalyFields"> <s:property value="getText('Country')"/> </td>
                                <td>
                                  <s:textfield name="shipFromCountry" cssClass="inputFields" id="shipFromCountryId" maxlength="2" size="10" onblur="shipFromCountryChgCase()" value="%{#aascShipmentHeaderInfo.shipFromCountry}"/>
                                </td>
                              </tr>
                            </table>
                            </td>
                          </tr>
                          <tr align="left" valign="top">
                            <td class="dispalyFields">  <s:property value="getText('PhoneNumber')"/> </td>
                            <td>
                              <s:textfield name="shipFromPhoneNumber1"  cssClass="inputFields"  id="shipFromPhoneNumber1" value="%{#aascShipmentHeaderInfo.shipFromPhoneNumber1}"/>
                            </td>
                          </tr>
                        </table>
                      </td>
                      <td width="15%" valign="top" height="35%">
                      <table width="100%" class="back"  height="100%">
                        <tr>
                          <td align="center" colspan="2"  class="headings" valign="top"><s:property value="getText('ShipTo')"/></td>
                        </tr>
                        <tr>
                          <td align="left" valign="top" class="dispalyFields"> <s:property value="getText('CustomerName')"/> </td>
                          <td align="left" valign="top" class="displayResults">
                            <% //madhavi
                            int userId = (Integer)session.getAttribute("user_id");;
                            /*String userIdstr = (String) session.getAttribute("UserId"); // getting UserId from session
                            logger.info("userIdstr = " + userIdstr);
                            if (userIdstr != null) {
                                userId = Integer.parseInt(userIdstr);
                                logger.info("userId in Shipment page=="+userId);
                            } else { 
                               logger.info("userIdstr is null");
                            }*/
                            //  AascShipmentOrderInfoDAO aascShipmentOrderInfoDAO = aascDAOFactory.getAascShipmentOrderInfoDAO();
                            String defaultPrinter = aascShipmentOrderInfoDAO.getDefaultPrinter(userId);
                            try
                            {
                              String defPrintStr=defaultPrinter.substring(0,1);
                            }
                            catch(Exception e)
                            {
                              defaultPrinter="";
                            }
                            logger.info("defaultPrinter in Shipment page=="+defaultPrinter);
                            //madhavi
                                AascOracleShipmentShippingAddr aascOracleShipmentShippingAddr=null;
                                aascOracleShipmentShippingAddr =new AascOracleShipmentShippingAddr();
                                ResultSet  reShipToAddress =null;
                                int location_id =((Integer)session.getAttribute("location_id")).intValue();
                                int userIdTmp = (Integer)session.getAttribute("user_id");
                                try
                                {
                                    //           logger.info("aascShipmentHeaderInfo.getShipFlag() :: "+aascShipmentHeaderInfo.getShipFlag());
                                    //           logger.info("aascShipmentHeaderInfo.setShipFromLocationId() :: "+aascShipmentHeaderInfo.setShipFromLocationId());
                                    //           if(aascShipmentHeaderInfo.setShipFromLocationId()!=""&&"Y".equalsIgnoreCase(aascShipmentHeaderInfo.getShipFlag()))
                                    //           {
                                    //          aascShipmentHeaderInfo= aascOracleShipmentShippingAddr.getShipFromAddr(aascShipmentHeaderInfo,location_id,clientIdInt,userIdTmp);
                                    //          }else
                                    //        {
                                    //                aascShipmentHeaderInfo.setShipFromAddressLine1("");
                                    //                aascShipmentHeaderInfo.setShipFromAddressLine2("");
                                    //                aascShipmentHeaderInfo.setShipFromAddressLine3("");
                                    //                aascShipmentHeaderInfo.setShipFromCity("");
                                    //                aascShipmentHeaderInfo.setShipFromState("");
                                    //                aascShipmentHeaderInfo.setShipFromCountry("");
                                    //                aascShipmentHeaderInfo.setShipFromPostalCode("");
                                    //                aascShipmentHeaderInfo.setShipFromPhoneNumber1("");
                                    //                aascShipmentHeaderInfo.setShipFromPhoneNumber2("");
                                    //        }
                                    reShipToAddress =(ResultSet)aascOracleShipmentShippingAddr.getShipToAddr(clientIdInt);
                                 }catch(Exception e)
                                 {
                                 e.printStackTrace();
                                 }
         
                                 try
                                 {
                                 %>
                                 <div class="ui-widget" id="ui-widgetShipToId">
                                   <select name="customerName" id="customerName" size="1" style="width:100%" onkeydown="fnKeyDownHandler(this, event);" onkeyup="fnKeyUpHandler_A(this, event); return false;" onkeypress="return fnKeyPressHandler_A(this, event);" onChange="fnChangeHandler_A(this, event);getShipToAddr1();" class="inputFields" <%=nullStringToSpace(ShipmentFlags.getReadOnlyFlag())%>  >
                                      <% if(ShipmentFlags.getSelectDisableFlag().equalsIgnoreCase("DISABLED") )
                                         {
                                      %>
                                      <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())%>">
                                        <%=nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())%>
                                      </option>
                                      <%}
                                      else{%>
                                      <option></option>
                                      <%
                                      int count=0;
                                      while(reShipToAddress.next())
                                      {
                                         if(!nullStringToSpace(aascShipmentHeaderInfo.getCustomerName()).equalsIgnoreCase(""))
                                         {
                                            if(!reShipToAddress.getString(1).equalsIgnoreCase(nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())))
                                            {
                                            count++;
                                            }
                                            
                                         }
                                         if(reShipToAddress.getString(1).equalsIgnoreCase(nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())))
                                         {
                                      %>
                                      <option selected="selected" value="<%=reShipToAddress.getString(1)%>"> <%=reShipToAddress.getString(1)%> </option>
                                      <% }else
                                         {%>
                                      <option value="<%=reShipToAddress.getString(1)%>"> <%=reShipToAddress.getString(1)%> </option>
                                          <%
                                         }
                                      }
                                      if(count>0)
                                      {
                                        ////logger.info("Entered if");
                                      
                                      %>
                                      <option selected="selected" value="<%=nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())%>"> <%=nullStringToSpace(aascShipmentHeaderInfo.getCustomerName())%> </option>
                                      <%
                                      }
                                    }
                                  }         
                                  catch(Exception e)
                                  {  e.printStackTrace();}
                                  finally
                                  {            
                                    try{            
                                      reShipToAddress.close();
                                    }
                                    catch(Exception e)
                                    {e.printStackTrace();}
                                  }
                                  %>
                                </select>
                              </div>
                            </td>
                        </tr>
                        <tr>
                          <td align="left" valign="middle" class="dispalyFields">  
                          <s:property value="getText('ContactName')"/>
                          </td>
                          <td align="left" valign="top">
                            <span class="style7">
                              <s:textfield name="contactName" cssClass="inputFields" id="contactNameId" value="%{#aascShipmentHeaderInfo.contactName}" maxlength="30" readonly="%{#attr.readOnlyFlag}"/>
                            </span>
                          </td>
                        </tr>
                        <tr>
                          <td align="left" valign="top" class="dispalyFields">
                            <s:property value="getText('PhoneNumber')"/>
                          </td>
                          <td align="left" valign="top">
                            <span class="style7">
                              <s:textfield name="phoneNumber" id="phoneNumberId" cssClass="inputFields" value="%{#aascShipmentHeaderInfo.phoneNumber}" readonly="%{#attr.readOnlyFlag}"/>
                            </span>
                          </td>
                        </tr>
                        <s:hidden name="shipMethodHidden" id="shipMethodHiddenId" value="%{#aascShipmentHeaderInfo.shippingMethod}"/>
                        <s:hidden name="shipMethodHide" id="shipMethodHideId" value="%{#shipMethodHidden1}"/>
                        <s:hidden name="shipMethodValue" id="shipMethodValueId"/>
                        <s:hidden name="CarrierAcHidden" id="CarrierAcHiddenId" value="%{''}"/>
                        <!--ajax hidden variables -->
                        <!--<s:set name="ajaxOriginRegionCode" value="%{#aascProfileOptionsInfo.originRegionCode}"/> -->
                        <s:set name="ajaxOriginRegionCode" value="%{#aascShipmentHeaderInfo.shipFromCountry}"/>
                        <s:set name="ajaxUpsMode" value="%{#connectionModeUPS}"/>
                        <s:set name="countryCodeProf" value="%{#aascProfileOptionsInfo.countryCode}"/>
                        <s:set name="" value=""/>
                        <%
                               Integer locationId = (Integer) session.getAttribute("location_id"); // Gettin Inventory location Id from session
                              logger.info("locationId   :"+locationId);
                              
                              int locationIdint = locationId.intValue();
                            
                              String intlSaveFlag= (String)session.getAttribute("intlSaveFlag");
                              pageContext.setAttribute("intlSaveFlag",intlSaveFlag);
                        
                              session.removeAttribute("intlSaveFlag");
                              pageContext.setAttribute("locationIdint",locationIdint);
                        
                        %>
                        <s:hidden name="locationStr1" id="locationStr1" value="%{#attr.locationIdint}"/>
                        <s:hidden name="countryProf" id="countryProf" value="%{#countryCodeProf}"/>
                        <s:hidden name="intlFlag" id="intlFlag"/>
                        <s:hidden name="flagShip" id="flagShipID" value="%{#aascShipmentHeaderInfo.shipFlag}"/>
                        <s:hidden name="intlSaveFlag" value="%{#attr.intlSaveFlag}"/>
                        <s:hidden name="shipmentType" value="%{'Shipment'}"/>
                        <s:hidden name="intTotalCustomsValue" value="%{#attr.intlSaveFlag}"/>
                        <s:hidden name="intlCustomsFlag" value="%{#session.intlCustomsFlag}"/>
                        <s:hidden name="intlWeightValue"/>
                        <s:hidden name="shipMethodText"/>
                        <s:hidden name="locationId" id="locationId" value="%{#session.location_id}"/>
                        <s:hidden name="shipPrint" id="shipPrint" value="%{#aascProfileOptionsInfo.shipPrint}"/> <!-- Added by Jagadish for ShipPrint functionality  -->
                       
                        <s:set name="intlCustomsFlag" value="%{'N'}" scope="session"/>
                        <s:hidden name="ajaxShipMethod" id="ajaxShipMethod"/>
                        <s:hidden name="ajaxCCodeCServiceLevel" id="ajaxCCodeCServiceLevel"/>
                        <s:hidden name="ajaxCarrierCode" id="ajaxCarrierCode"/>
                        <s:hidden name="ajaxcarrierservicelevel" id="ajaxcarrierservicelevel"/>
                        <s:hidden name="ajaxDropOffType" id="ajaxDropOffType"/>
                        <s:hidden name="ajaxPackaging" id="ajaxPackaging"/>
                        <s:hidden name="ajaxCarrierPaymentTerms" id="ajaxCarrierPaymentTerms"/>
                        <s:hidden name="ajaxOriginRegionCode" id="ajaxOriginRegionCode" value="%{#ajaxOriginRegionCode}"/>                       <s:hidden name="ajaxUpsMode" id="ajaxUpsMode" value="%{#ajaxUpsMode}"/>
                        <s:hidden name="ajaxUpsServiceLevelCode" id="ajaxUpsServiceLevelCode"/>
                        <s:hidden name="ajaxDimensionReq" id="ajaxDimensionReq"/>
                        <s:hidden name="ajaxMaxWeight" id="ajaxMaxWeight"/>
                        <s:hidden name="ajaxMaxLength" id="ajaxMaxLength"/>
                        <s:hidden name="ajaxMinLength" id="ajaxMinLength"/>
                        <s:hidden name="ajaxMaxWidth" id="ajaxMaxWidth"/>
                        <s:hidden name="ajaxMinWidth" id="ajaxMinWidth"/>
                        <s:hidden name="ajaxMaxHeight" id="ajaxMaxHeight"/>
                        <s:hidden name="ajaxMinHeight" id="ajaxMinHeight"/>
                        <s:hidden name="packaging" id="packaging" value="%{#aascShipmentHeaderInfo.packaging}"/>
                        <s:hidden name="dropOfType" id="dropOfType" value="%{#aascShipmentHeaderInfo.dropOfType}"/>
                        <s:hidden name="shipFromLocation" id="shipFromLocation" value="%{#aascShipmentHeaderInfo.shipFromLocation}"/>
                        <s:hidden name="shipFromAddressLine1" id="shipFromAddressLine1" value="%{#aascShipmentHeaderInfo.shipFromAddressLine1}"/>
                        <s:hidden name="shipFromAddressLine2" id="shipFromAddressLine2"value="%{#aascShipmentHeaderInfo.shipFromAddressLine2}"/>
                        <s:hidden name="shipFromCity" id="shipFromCity" value="%{#aascShipmentHeaderInfo.shipFromCity}"/>
                        <s:hidden name="shipFromState" id="shipFromState" value="%{#aascShipmentHeaderInfo.shipFromState}"/>
                        <s:hidden name="shipFromPostalCode" id="shipFromPostalCode" value="%{#aascShipmentHeaderInfo.shipFromPostalCode}"/>
                        <s:hidden name="shipFromCountry" id="shipFromCountry" value="%{#aascShipmentHeaderInfo.shipFromCountry}"/>
                        <s:hidden name="shipFromPhoneNumber1" id="shipFromPhoneNumber1" value="%{#aascShipmentHeaderInfo.shipFromPhoneNumber1}"/>
                        <s:hidden name="shipFromPhoneNumber2" id="shipFromPhoneNumber2" value="%{#aascShipmentHeaderInfo.shipFromPhoneNumber2}"/>
                        <tr>
                          <td align="left" valign="top" class="dispalyFields"> <s:property value="getText('Addressline1')"/> </td>
                          <td align="left" valign="top" class="displayResults"> 
                          <select name="shipToAddress"  id="shipToAddressId" size="1" style="width:150px" onkeydown="fnKeyDownHandler(this, event);" onkeyup="fnKeyUpHandler_B(this, event); return false;" onkeypress="return fnKeyPressHandler_B(this, event);" onchange="getShipToAddress();fnChangeHandler_B(this, event); " class="inputFields" <%=nullStringToSpace(ShipmentFlags.getReadOnlyFlag())%>>>
                              <option> <%=aascShipmentHeaderInfo.getAddress()%> </option>
                          </select>
                          </td>
                        </tr>
                        <tr>
                            <td>
                              <span class="dispalyFields">
                                <s:property value="getText('Addressline2')"/>
                              </span>
                            </td>
                            <td>
                              <span class="displayResults">
                                <s:textfield name="shipToAddrLine2" id="shipToAddrLine2Id" value="%{#aascShipmentHeaderInfo.shipToAddrLine2}" cssClass="inputFields"  size="20" maxlength="35" readonly="%{#attr.readOnlyFlag}"/>
                              </span>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" nowrap="nowrap">
                              <table>
                                <tr>
                                  <td> <span class="dispalyFields"><s:property value="getText('City')"/>  </span> </td>
                                  <td> <span class="displayResults">
                                    <s:textfield name="city"  value="%{#aascShipmentHeaderInfo.city}"  cssClass="inputFields"  id="city" size="10" readonly="%{#attr.readOnlyFlag}"/>
                                    </span> </td>
                                  <td align="left" valign="top" class="dispalyFields"><s:property value="getText('State')"/> </td>
                                  <td align="left" valign="top" class="displayResults">
                                    <s:textfield name="state" value="%{#aascShipmentHeaderInfo.state}" cssClass="inputFields" id="state" size="10" onblur="changeCase()" readonly="%{#attr.readOnlyFlag}"/>
                                  </td>
                                </tr>
                                <tr>
                                  <td align="left" valign="top" class="dispalyFields"> <s:property value="getText('CountryCode')"/> </td>
                                  <td align="left" valign="top" class="displayResults"> 
                                  <s:textfield name="countrySymbol" value="%{#aascShipmentHeaderInfo.countrySymbol}" cssClass="inputFields" id="country" size="10" maxlength="25" onblur="countryValidate();" readonly="%{#attr.readOnlyFlag}"/>
                                    <b>(e.g:US)</b> </td>
                                  <td align="left" valign="top" nowrap="nowrap" class="dispalyFields"> <s:property value="getText('Zip')"/> </td>
                                  <td align="left" valign="top" class="displayResults">
                                    <s:textfield name="postalCode" value="%{#aascShipmentHeaderInfo.postalCode}" cssClass="inputFields" id="zip" size="10" maxlength="45" readonly="%{#attr.readOnlyFlag}"/>
                                  </td>
                                </tr>
                              </table>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" nowrap="nowrap">&nbsp;</td>
                        </tr>
                      </table>
                      </td>
                      <td width="15%" valign="top" height="35%">
                        <table width="100%" align="center" bgcolor="#dddddd" class="back">
                          <tr>
                            <td colspan="4" align="center" class="headings"><s:property value="getText('Result')"/>
                            </td>
                          </tr>
                          <tr>
                            <td align="left" valign="top" nowrap="nowrap"  class="dispalyFields" width="50%"> <s:property value="getText('Waybill/TrackingNo')"/> </td>
                            <td width="50%" align="left" valign="top">
                            <% 
                             String readOnlyFlag=ShipmentFlags.getReadOnlyFlag();
                           
                             pageContext.setAttribute("readOnlyFlag",readOnlyFlag);
                             pageContext.setAttribute("ShipmentFlags",ShipmentFlags);
                            
                           %>
                           <s:set name="ShipmentFlags" value="%{#attr.ShipmentFlags}"/>
                           <s:textfield name="wayBill"   id="wayBillId"  cssClass="inputFields" maxlength="20" value="%{#aascShipmentHeaderInfo.wayBill}" readonly="%{#attr.readOnlyFlag}"/>
                           </td>
                         </tr>
                         <tr>
                           <td align="left" valign="top" nowrap="nowrap" class="dispalyFields" width="25%">
                             <b>Total Weight</b>
                           </td>
                           <td width="25%">
                             <%
                                String disableFlagTmp=ShipmentFlags.getDisableFlag();
                                if("DISABLED".equalsIgnoreCase(disableFlagTmp)){
                                    disableFlagTmp="true";          
                                }
                                pageContext.setAttribute("disableFlagTmp",disableFlagTmp);
               
                             %>
                              <s:set name="disableFlagTmp" value="%{#attr.disableFlagTmp}"/>
                              <s:textfield name="packageWeight" disabled="%{#disableFlagTmp}" cssClass="inputFields" id="totalWeightText" value="%{#aascShipmentHeaderInfo.packageWeight}"   size="10" maxlength="10" /> 
                            </td>
                            <%!int selectedCarrier=0;%>
                            <%
                              //madhavi
                              aascShipmentOrderInfoDAO = aascDAOFactory.getAascShipmentOrderInfoDAO();
                              if((aascShipmentHeaderInfo.getShipFlag()).equalsIgnoreCase("Y"))
                              {
                              
                                // AascShipmentOrderInfo aascShipmentOrderInfoSaved2 = new AascShipmentOrderInfo();
                                AascShipmentOrderInfo aascShipmentOrderInfoSaved2 =  aascShipmentOrderInfoDAO.getShipmentOrderInfo(aascShipmentHeaderInfo.getOrderNumber(),clientIdInt);       
                                
                    
                                Double freightcostShip=aascShipmentOrderInfoSaved2.getShipmentHeaderInfo().getFreightCost();
                                Double shipcostShip=aascShipmentOrderInfoSaved2.getShipmentHeaderInfo().getShipmentCost();
                                aascShipmentHeaderInfo.setFreightCost(freightcostShip);
                                aascShipmentHeaderInfo.setShipmentCost(shipcostShip);
                                aascShipmentHeaderInfo.setDropOfType(aascShipmentOrderInfoSaved2.getShipmentHeaderInfo().getDropOfType());
                                aascShipmentHeaderInfo.setPackaging(aascShipmentOrderInfoSaved2.getShipmentHeaderInfo().getPackaging());
                                aascShipmentHeaderInfo.setCarrierPaymentMethod(aascShipmentOrderInfoSaved2.getShipmentHeaderInfo().getCarrierPaymentMethod());
                              }
              
                              String ShipCostStr=Double.toString(aascShipmentHeaderInfo.getShipmentCost());

                              int i =ShipCostStr.indexOf(".");
              
                              if(i<1)
                              {
                              ShipCostStr=ShipCostStr+".00";
                              }
                              else if((ShipCostStr.length()-i)>2)
                              {
                              ShipCostStr=ShipCostStr.substring(0,i+3);
                              }
                              else
                              {
                                 while(ShipCostStr.length()!=(i+3))
                              {
                                ShipCostStr=ShipCostStr+"0";
                              }
                            }
                            pageContext.setAttribute("ShipCostStr",ShipCostStr);
                                                   
                          %>
                            <td align="left" valign="top"  nowrap="nowrap" class="dispalyFields" width="25%"> <s:property value="getText('ShipmentCost')"/>
                            </td>
                            <td width="25%">
                                <s:textfield name="shipmentCost"  id="shipmentCostId" value="%{#attr.ShipCostStr}"  size="5" cssClass="inputFields"  readonly="%{#attr.readOnlyFlag}"/>
                            </td>
                          </tr>
                          <tr>
                            <%
                      
                              String freightCostStr=Double.toString(aascShipmentHeaderInfo.getFreightCost());
                              i =freightCostStr.indexOf(".");
                              if(i<1)
                              {
                                    freightCostStr=freightCostStr+".00";
                              }
                              else if((freightCostStr.length()-i)>2)
                              {
                                freightCostStr=freightCostStr.substring(0,i+3);
                              }
                              else
                              {
                                 while(freightCostStr.length()!=(i+3))
                                 {
                                   freightCostStr=freightCostStr+"0";
                                 } 
                              }
                              pageContext.setAttribute("freightCostStr",freightCostStr);
                              pageContext.setAttribute("aascShipmentHeaderInfo",aascShipmentHeaderInfo);
                            %>
                            <s:set name="freightCostStr" value="%{#attr.freightCostStr}"/>
                            <s:set name="aascShipmentHeaderInfo"  value="%{#attr.aascShipmentHeaderInfo}"/>
                            <td align="left" valign="top" nowrap="nowrap"  class="dispalyFields" width="25%">
                              <s:property value="getText('FreightCharges')"/>
                            </td>
                            <td width="25%">
                              <s:textfield name="ShipFreightTextBox" cssClass="inputFields"  id="ShipFreightTextBox"  value="%{#freightCostStr}"  size="5" readonly="%{#attr.readOnlyFlag}"/>
                            </td>
                            <td align="left" valign="top"  nowrap="nowrap"  class="dispalyFields" width="25%"> <s:property value="getText('TotalSurcharge')"/>
                            </td>
                            <td width="25%">
                              <s:textfield cssClass="inputFields"  name="totalSurcharge" id="totalSurchargeId" size="5"  value="%{#aascShipmentHeaderInfo.totalSurcharge}"  readonly="%{#attr.readOnlyFlag}"/>
                            </td>
                            <s:hidden value="%{#carrierPayMethodHide}"  name="carrierPayMethodHide" id="carrierPayMethodHide"/>
                          </tr>
                          <tr>
                            <td align="center" height="25"  colspan="4">
                              <input type="hidden"  name="saveButton" value=""/>
                              <s:if test='%{#ShipmentFlags.saveDisableFlag == "DISABLED"}'>
                                <img src="buttons/aascShipOff1.png"  name="submitButton"  id="submitButtonDisabled" align="middle"></img>
                              </s:if>
                              <s:else>
                                <input type="image" align="middle"   src="buttons/aascShip1.png"  alt="[submit]"  name="submitButton"  id="submitButtonEnabled" onclick="submitButtonId.value='Ship';shipButtonValue(); return disableSubmit();"></input>
                              </s:else>
                              &nbsp;&nbsp;&nbsp;
                              <s:if test='%{#ShipmentFlags.printDisableFlag == "DISABLED"}'>
                                <img src="buttons/aascVoidOff1.png" id="voidDisabled" name="submitButton" align="middle"></img>
                              </s:if>
                              <s:else>
                                <input type="image" align="middle"  src="buttons/aascVoid1.png"  alt="[Submit]"  name="submitButton" id="voidButton"  onclick="submitButtonId.value='Void';return disableSubmit()"></input>
                              </s:else>
                            </td>
                          </tr>
                        </table>
                        <!--
                        <table width="100%" align="center"  bgcolor="#dddddd" class="back">
                          <tr>
                            <td colspan="4" align="center" class="headings">Print Label</td>
                          </tr>
                          <tr>
                            <td width="35%" class="dispalyFields">
                              <s:property value="getText('Printer')"/>
                            </td>
                            <td>
                              <% try
                               {
                                 if(printerList!=null)
                                 {
                              %>
                                  <select name="printer"  id="printerID" size="1"  class="inputFields"  onchange="FillTask(this,template)" <%=nullStringToSpace(ShipmentFlags.getPrintDisableFlag())%> >>
                                    <option value="">Select the Printer</option>
                              <%  
                                    while(printerIterator.hasNext())
                                    {
                                     String printerElement=(String)printerIterator.next();
                                     if((nullStringToSpace(aascShipmentHeaderInfo.getPrinter())).equalsIgnoreCase(printerElement))
                                     {
                              %>
                                    <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getPrinter())%>" selected="selected"> <%=  nullStringToSpace(aascShipmentHeaderInfo.getPrinter())%> </option>
                              <%     } else {
                                         //Added
                                        if(printerElement.equalsIgnoreCase(defaultPrinter)&&(aascShipmentHeaderInfo.getPrinter()==""))
                                        {
                              %>
                                    <option value="<%= printerElement%>" selected="selected"> <%= printerElement%> </option>
                              <%        }
                                        else
                                        {
                              %>
                                    <option value="<%= printerElement%>"> <%= printerElement%> </option>
                              <%
                                        }
                                     }  
                                    }
                              %>
                                  </select>
                              <%    
                              }
                            }
                            catch(Exception e)
                            {
                                logger.severe("exception while creating the printer list"+e.getMessage());
                                e.printStackTrace();
                                response.sendRedirect(url+"/aascShipError.jsp");
                            }
                          %>
                            </td>
                          </tr>
                          <tr>
                            <td width="35%" class="dispalyFields">
                              <s:property value="getText('Template')"/>
                            </td>
                            <td> -->
                              <%try
                                {
                                    int CarrierCode1=0;
                                    shipMethodIterator=(aascShipMethodInfoForTemplate.getShipMethodDetailList()).listIterator();
                                    logger.info("aascShipMethodInfoForTemplate.getShipMethodDetailList() for template::"+aascShipMethodInfoForTemplate.getShipMethodDetailList());
                                    while(shipMethodIterator.hasNext())
                                    {  
                                      AascShipMethodInfo  aascShipMethodInfoBean = (AascShipMethodInfo)shipMethodIterator.next();                   
                                      if(aascShipMethodInfoBean.getEnabledFlag().equalsIgnoreCase("Y") )          
                                      {
                                        String shipMethodElementAlt=(String) aascShipMethodInfoBean.getAlternateShipMethod();//getShipMethodMeaning();// 
                                        logger.info("shipMethodElementAlt for template::"+shipMethodElementAlt);
                                        String shipMethodElement = (String)aascShipMethodInfoForTemplate.getShipMethodFromAlt(shipMethodElementAlt);// 
                                        logger.info("shipMethodElement : "+shipMethodElement);
                                        int carrierId2= aascShipMethodInfoForTemplate.getCarrierId(shipMethodElement);    
                                        logger.info("carrierId2 : "+carrierId2);
                                        int  CarrierCode2 = aascShipMethodInfoForTemplate.getCarrierCode(carrierId2); 
                                        logger.info("CarrierCode2 : "+CarrierCode2);
                                        String shipMethodValidationShipment= aascShipMethodInfoForTemplate.getShipmentValidationCode(shipMethodElement);
                                        logger.info("shipMethodValidationShipment : "+shipMethodValidationShipment);
                                        String CarreirAC = aascShipMethodInfoForTemplate.getCarrierAccountNumber(carrierId2);
                                        logger.info("CarreirAC : "+CarreirAC);
                                        if(aascShipmentHeaderInfo.getShipMethodMeaning().equals(shipMethodElement))
                                        {
                                          logger.info(" CarrierCode for selected Shipmethod " +CarrierCode2);
                                          CarrierCode1=CarrierCode2;
                                          selectedCarrier=CarrierCode2;
                                          pageContext.setAttribute("selectedCarrier",selectedCarrier);
                                        }
                                      }
                                    }    
                                    /*String templateStr = "";
                                    if (CarrierCode1==100||CarrierCode1==110||CarrierCode1==111 ||CarrierCode1==0)
                                    { */
                              %>
                                <!--<select name="template"  id="template1Id" size="1"  class="inputFields"  disabled="disabled">
                                  <option value="">--Select Template--</option>
                                </select>
                              <%
                                    /*}
                                    else
                                    {
                                      if(templateList!=null)
                                      {  */
                             %>
                                <select name="template" id="template2Id" size="1" class="inputFields" <%=nullStringToSpace(ShipmentFlags.getTemplateDisableFlag())%>>>
                             <%  
                                       /*String printerName2=(String)request.getParameter("printer");
                                       logger.info("printerName="+printerName2);
                                       if(printerName2 == null) 
                                       printerName2 ="";
                                       if(aascShipmentHeaderInfo.getTemplate().equalsIgnoreCase(""))
                                       {*/
                            %>
                                         <option selected="selected">Select the template</option>
                            <%         /*} else {  */ %>
                                         <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%>" selected="selected"> <%=  nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%> </option>
                            <%         /*} while(templateIterator.hasNext())
                                       {
                                         AascTemplateInfo templateElement=(AascTemplateInfo)templateIterator.next();
                                         logger.info("templateElement "+templateElement.getTemplateName());
                                         String tempName=templateElement.getTemplateName();
                                         String prinName=templateElement.getPrinterName();
                                         if(printerName2.equalsIgnoreCase(prinName))
                                         {*/
                            %>
                                          <option value="">  </option>
                                      <% /*} 
                                        }  */
                                      %>
                                </select>
                                <%    
                                      /*}
                                      else 
                                      {*/
                                %>
                                <select name="template" id="template3Id" size="1" class="buttonDataCell">
                                    <% /*if(aascShipmentHeaderInfo.getTemplate().equalsIgnoreCase(""))
                                       { */%>
                                          <option selected="selected">Select the template</option>
                                    <% /*} else {*/  %>
                                          <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%>" selected="selected"> <%=  nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%> </option>
                                    <% //} %>   
                                          <option value="<%=nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%>"> <%=    nullStringToSpace(aascShipmentHeaderInfo.getTemplate())%> </option>  -->
                                <%    /*} 
                                  }*/
                                }
                                catch(Exception e)
                                {
                                    //logger.log(Level.SEVERE,"while setting the template for delivery "+headerInfo.getDeliveryName(),e);
                                    e.printStackTrace();
                                }
                                %>
                                <!--</select>
                            </td>
                          </tr>
                          <tr>
                            <td colspan="2" align="center">
                              <%
                              if(((ShipmentFlags.getPrintDisableFlag()).trim()).equals("DISABLED"))
                                {
                              %>
                              <img src="buttons/aascPrintOff1.png" name="submitButton" id="printLabelDisabled" align="middle"/>
                              <%
                                }
                                else
                                {
                              %>
                              <input name="submitButton" type="image" src="buttons/aascPrint1.png" alt="[submit]" id="printLabel123" align="middle" onclick="submitButton.value='Print Label';return templatePrinter();templateCheck();return disableSubmit();" <%=nullStringToSpace(ShipmentFlags.getPrintDisableFlag())%>>>
                              <%
                                }
                              %>
                            </td>
                            <td>&nbsp;</td>
                          </tr>
                        </table>
                        -->
                     </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
         </td>
        </s:form>
        </tr>
      </table>
      </div>
      </td>  
    </tr>
    <tr align="left" valign="top">
      <td colspan="3" style="border: 0px; border-collapse: collapse;">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td valign="top">
            <table width="45%" class="back" align="right">
              <tr>
                <td valign="top" align="center" colspan="2"  class="headings"><s:property value="getText('Service')"/></td>
              </tr>
              <tr>
                <td align="left" valign="top" class="dispalyFields"  width="15%">  
                <s:property value="getText('ShipMethod')"/> <br/>
                </td>
                <td align="left" valign="top" width="30%">
                  <c:catch var="exception">
                    <s:if test="%{#aascCarrierProfileOptionsInfo == null}">
                      <s:set name="carrierProfileOptionsShipmethod"  value="%{''}"/>
                    </s:if>
                    <s:else>
                      <s:if test="%{#aascCarrierProfileOptionsInfo.shipMethodMeaning == null}">
                        <s:set name="carrierProfileOptionsShipmethod"  value="%{''}"/>
                      </s:if>
                      <s:else>
                        <s:set name="carrierProfileOptionsShipmethod"  value="%{#aascCarrierProfileOptionsInfo.shipMethodMeaning}"/>
                      </s:else>
                    </s:else>
                    <s:if test="%{#carrierProfileOptionsShipmethod == ''}">
                      <s:hidden name="carrierProfileOptionsShipmethodHidden"value="%{''}"/>
                    </s:if>
                    <s:else>
                      <s:hidden name="carrierProfileOptionsShipmethodHidden" value="%{#aascCarrierProfileOptionsInfo.shipMethodMeaning}"/>
                    </s:else>
                    <s:set name="ProfileDropOffType"  value="%{#aascCarrierProfileOptionsInfo.dropOffType}"/>
                    <s:set name="ProfileCarrierPaymethod" value="%{#aascCarrierProfileOptionsInfo.carrierPaymentTerms}"/>
                    <s:set name="ProfileCarrierPackaging" value="%{#aascCarrierProfileOptionsInfo.packaging}"/>
                    <s:set name="sigOptions" value="%{#aascCarrierProfileOptionsInfo.signatureOptions}"/>
                    <s:set name="CODFlag" value="%{#aascCarrierProfileOptionsInfo.codFlag}"/>
                    <s:set name="ReturnFlag" value="%{#aascCarrierProfileOptionsInfo.returnShipmentFlag}"/>
                    <s:set name="CODFundsCode" value="%{#aascCarrierProfileOptionsInfo.codFundsCode}"/>
                    <s:set name="CODCurrCode" value="%{#aascCarrierProfileOptionsInfo.codCurrCode}"/>
                    <s:set name="CODType" value="%{#aascCarrierProfileOptionsInfo.codType}"/>
                    <s:set name="HALFlag" value="%{#aascCarrierProfileOptionsInfo.halFlag}"/>
                    <s:set name="ProfileHazmatFlag" value="%{#aascCarrierProfileOptionsInfo.hazmatFlag}"/>
                  </c:catch>
                  <s:if test="%{#exception != null}">
                    <s:set name="aascCarrierProfileOptionsInfo" value="%{''}"/>
                  </s:if>
                  <s:hidden name="ProfileDropOffTypeHidden" id="ProfileDropOffTypeHiddenID" value="%{ProfileDropOffType}"/>
                  <s:hidden name="ProfileCarrierPaymethodHidden" id="ProfileCarrierPaymethodHiddenID" value="%{ProfileCarrierPaymethod}"/>
                  <s:hidden name="ProfileCarrierPackagingHidden" id="ProfileCarrierPackagingHiddenID" value="%{ProfileCarrierPackaging}"/>
                  <s:hidden name="sigOptionsHidden" id="sigOptionsHiddenID" value="%{sigOptions}"/>
                  <s:hidden name="CODFlagHidden" id="CODFlagHiddenID" value="%{CODFlag}"/>
                  <s:hidden name="HALFlagHidden" id="HALFlagHiddenID" value="%{HALFlag}"/>
                  <s:hidden name="ReturnFlagHidden" id="ReturnFlagHiddenID" value="%{ReturnFlag}"/>
                  <s:hidden name="CODFundsCodeHidden" id="CODFundsCodeHiddenID" value="%{CODFundsCode}"/>
                  <s:hidden name="CODCurrCodeHidden" id="CODCurrCodeHiddenID" value="%{CODCurrCode}"/>
                  <s:hidden name="CODTypeHidden" id="CODTypeHiddenID" value="%{CODType}"/>
                  <s:hidden name="ProfileHazmatFlagHidden" id="ProfileHazmatFlagHiddenID" value="%{ProfileHazmatFlag}"/>
                  <%      
                      AascCarrierProfileOptionsInfo aascCarrierProfileOptionsInfo = null;
                      AascProfileOptionsBean aascProfileOptionsInfo =(AascProfileOptionsBean)session.getAttribute("ProfileOptionsInfo");
                      /*String defaultCarrierSessionValuesFlag= aascProfileOptionsInfo.getDefaultCarrierSessionValuesFlag();
                      if(defaultCarrierSessionValuesFlag==null)
                      {
                          defaultCarrierSessionValuesFlag="";
                      }
                      if("Y".equalsIgnoreCase(defaultCarrierSessionValuesFlag))
                      {
                          aascCarrierProfileOptionsInfo = (AascCarrierProfileOptionsInfo)session.getAttribute("CarrierProfileOptionsInfo");
                      }*/

                      // Added for fix bug#2033
                      String shipMethodMeaning=""; 
                      if(aascShipmentHeaderInfo.getShipFlag().equalsIgnoreCase("Y")){
                        shipMethodMeaning=aascShipmentHeaderInfo.getShippingMethod();
                      }           
                  %>
                  <select name="shipMethod" id="shipMethodId" size="1" style="width:100%" class="inputFields"  title="<%=shipMethodMeaning%>" onmouseover="showTip(this,event)" onmouseout="hideTip()" onchange="FillCarrier();chgShipMethod();getCcCsl('2');" <%=ShipmentFlags.getSelectDisableFlag()%>>>
                  <%
                   int carrierIdInt = aascShipmentHeaderInfo.getCarrierId();
                   logger.info("carrierIdInt : "+carrierIdInt);
                   int carrierCodeInt = aascShipMethodInfo.getCarrierCode(carrierIdInt);
                   logger.info("carrierCodeInt : "+carrierCodeInt);
                   String shipMethod = carrierCodeInt+"*"+nullStringToSpace(aascShipmentHeaderInfo.getShippingMethod());
                   logger.info("shipMethod : "+shipMethod);
                   shipMethodValidation = aascShipMethodInfo.getShipmentValidationCode(nullStringToSpace(aascShipmentHeaderInfo.getShippingMethod()));
                   logger.info("shipMethodValidation : "+shipMethodValidation);
                   shipMethod = carrierCodeInt+"||"+shipMethodValidation+"*"+nullStringToSpace(aascShipmentHeaderInfo.getShippingMethod());
              
                   logger.info("shipMethod in jsp ::"+shipMethod);
                   logger.info("aascShipmentHeaderInfo.getShipFlag() : "+aascShipmentHeaderInfo.getShipFlag()+"  ShipmentFlags.getSelectDisableFlag() : "+ShipmentFlags.getSelectDisableFlag());
                   if(aascShipmentHeaderInfo.getShipFlag().equalsIgnoreCase("Y") && ShipmentFlags.getSelectDisableFlag().equalsIgnoreCase("DISABLED"))
                   //if(true)
                   {
                      ListIterator shipMethodMainIterator=null;
    
                      AascShipMethodInfo aascShipMethodInfoMain=(AascShipMethodInfo)session.getAttribute("ShipMethodInfo");
    
                      shipMethodMainIterator=(aascShipMethodInfoMain.getShipMethodDetailList()).listIterator(); 
                      String shipMethodElementValue="";
                      while(shipMethodMainIterator.hasNext())
                      {  
                        AascShipMethodInfo aascShipMethodMainInfo=(AascShipMethodInfo)shipMethodMainIterator.next(); 
                        String shipMethodElementAlt=(String) aascShipMethodMainInfo.getAlternateShipMethod();//getShipMethodMeaning();// 
                        logger.info("shipMethodElementAlt : "+shipMethodElementAlt);
                        String shipMethodElement = (String)aascShipMethodInfoMain.getShipMethodFromAlt(shipMethodElementAlt);// 
                                   
                        String shipMethodValue1=shipMethodElement;//(String) aascShipMethodMainInfo.getAlternateShipMethod();//getShipMethodMeaning();// 
                        String shipMethodValue2=aascShipmentHeaderInfo.getShipMethodMeaning();
                        logger.info("shipMethodValue1 :"+shipMethodValue1);
                        logger.info("shipMethodValue2 :"+shipMethodValue2);
                       
                        if (shipMethodValue1.equalsIgnoreCase(shipMethodValue2))
                        {
                          shipMethodElementValue = shipMethodElementAlt; 
                        }
                      }
                   %>
                   <option value="<%=shipMethod%>" id="<%=nullStringToSpace(aascShipmentHeaderInfo.getCarrierAccountNumber())%>"> <%=shipMethodElementValue%> </option>
                   <input type="hidden" name="shipMethodProfHid" id="shipMethodProfHidId" value="<%=shipMethodElementValue%>"/>
                   <%
                   }
                   else if(aascShipmentHeaderInfo.getShipFlag().equalsIgnoreCase("N") && (aascCarrierProfileOptionsInfo!=null))
                   {
                   %>
                    <s:hidden name="shipMethodProfHid" id="shipMethodProfHidId" value="%{#aascCarrierProfileOptionsInfo.shipMethodMeaning}"/>
                    <%
                      }else{
                    %>
                    <s:hidden name="shipMethodProfHid" id="shipMethodProfHidId" value="%{#aascShipmentHeaderInfo.shippingMethod}"/>
                    <%
                  }
                  %>
                  </select>
                  <span id="tooltip"  style="position:absolute;visibility:hidden;background:lightyellow; border:1px gray;padding:2px;font-size:7pt;font-family:Verdana;width:240;" onMouseOut="hideTip()"></span>
                  <s:if test='%{#aascCarrierProfileOptionsInfo != null && #aascCarrierProfileOptionsInfo != "" && (#aascShipmentHeaderInfo.shipFlag == "N" || #aascShipmentHeaderInfo.shipFlag == "n")}'>
                    <s:if test='%{#CODFlag == "Y" || #CODFlag == "y" || #ReturnFlag == "Y" || #ReturnFlag == "y" || #sigOptions != "NONE" && #sigOptions != "none"}'>
                      <s:hidden name="defaultPackageOption" id="defaultPackageOption"  value="%{'true'}"/>
                    </s:if>
                    <s:else>
                      <s:hidden name="defaultPackageOption" id="defaultPackageOption"  value="%{'false'}"/>
                    </s:else>
                  </s:if>
                  <s:else>
                    <s:hidden name="defaultPackageOption" id="defaultPackageOption" value="%{'false'}"/>
                    <s:set name="aascCarrierProfileOptionsInfo"  value="%{'null'}"/>
                  </s:else>
                  <s:if test="%{#aascCarrierProfileOptionsInfo != null && #aascCarrierProfileOptionsInfo != '' && (#aascShipmentHeaderInfo.shipFlag == 'N' || #aascShipmentHeaderInfo.shipFlag == 'n')}">
                    <s:set name="packCount" value="%{1}"/>
                    <s:if test='%{#CODFlag != "" || #ReturnFlag != "" || #CODFundsCode != "" || #CODCurrCode != "" || #CODType != "" || #ProfileCarrierPackaging != "" || #sigOptions != "NONE" && #sigOptions != "none"}'>
                        <s:hidden name="pkging%{#packCount}" id="pkgingID%{#packCount}"  value="%{#ProfileCarrierPackaging}"/>
                        <s:hidden name="signatureOption%{#packCount}"  id="signatureOptionID%{#packCount}"  value="%{#sigOptions}"/>
                        <s:hidden name="delConfirm%{#packCount}" id="delConfirmID%{#packCount}"  value="%{#sigOptions}"/>
                        <s:hidden name="codType%{#packCount}"  id="codTypeID%{#packCount}"  value="%{#CODType}"/>
                        <s:hidden name="codFundsCode%{#packCount}"  id="codFundsCodeID%{#packCount}" value="%{#CODFundsCode}"/>
                        <s:hidden name="codCurrCode%{#packCount}"  id="codCurrCodeID%{#packCount}" value="%{#CODCurrCode}"/>
                        <s:hidden name="chCOD%{#packCount}" id="chCODID%{#packCount}"  value="%{#CODFlag}"/>
                        <s:hidden name="returnShipment%{#packCount}" id="returnShipmentID%{#packCount}" value="%{#ReturnFlag}"/>
                        <s:hidden name="holdAtLocation%{#packCount}" id="holdAtLocationID%{#packCount}" value="%{#HALFlag}"/>
                        <s:hidden name="carrierProfileOptionsShipmethod" id="carrierProfileOptionsShipmethodID" value="%{#carrierProfileOptionsShipmethod}"/>
                        <s:hidden name="ProfileDropOffType" id="ProfileDropOffTypeID" value="%{#ProfileDropOffType}"/>
                        <s:hidden name="ProfileCarrierPackaging" id="ProfileCarrierPackagingID" value="%{#ProfileCarrierPackaging}"/>
                        <input type="HIDDEN" name="ProfileCarrierPaymethod"  id="ProfileCarrierPaymethodID" value="%{#ProfileCarrierPaymethod}"/>
                    </s:if>
                  </s:if>
                </td>
              </tr>
              <tr>
                <td align="left" valign="top" class="dispalyFields" width="15%"> <s:property value="getText('DropOfType')"/></td>
                <td align="left" width="30%">
                <select name="dropOftype" id="dropOftypeId" disabled="disabled" class="inputFields" onchange="getPackageList('','','');">
                <%
                  ////Added by Sambit to display default DropoffType if session is not null and shipflag is N
                  if((aascCarrierProfileOptionsInfo!=null)&&(aascShipmentHeaderInfo.getShipFlag()).equalsIgnoreCase("N"))
                  { 
                %>
                <option value="<%=aascCarrierProfileOptionsInfo.getDropOffType()%>"> <%=aascCarrierProfileOptionsInfo.getDropOffType()%> </option>
                <input type="hidden" name="ajaxAfterShipDropOffType" id="ajaxAfterShipDropOffType" value="<%=aascCarrierProfileOptionsInfo.getDropOffType()%>"/>
                <%
                  } 
                  else
                  {           
                %>
                <option value="<%=aascShipmentHeaderInfo.getDropOfType()%>"> <%=aascShipmentHeaderInfo.getDropOfType()%> </option>
                <input type="hidden" name="ajaxAfterShipDropOffType" id="ajaxAfterShipDropOffType" value="<%=aascShipmentHeaderInfo.getDropOfType()%>"/>
                <%
                  }
                %>
                </select>
                <s:hidden name="kDropOffType" id="kDropOffTypeID" value="%{#aascShipmentHeaderInfo.dropOfType}"/>
                </td>
              </tr>
              <tr>
              <td align="left" valign="top" class="dispalyFields" width="15%">  <s:property value="getText('Packaging')"/> </td>
              <td align="left" valign="top" class="style7" width="30%">
                <select name="packages" id="packagesId"  disabled="disabled" class="inputFields"  onchange="getCarrierPayMethod('','');changeDimensions();"><!--Added "disabled" by Shiva-->
                <%
                   //Added by Sambit to display default Packaging if session is not null and shipflag is N
                    if((aascCarrierProfileOptionsInfo!=null)&&(aascShipmentHeaderInfo.getShipFlag()).equalsIgnoreCase("N"))
                    { 
                %>
                <option value="<%=aascCarrierProfileOptionsInfo.getPackaging()%>"> <%=aascCarrierProfileOptionsInfo.getPackaging()%> </option>
                <input type="hidden" name="ajaxAfterShipPackaging" id="ajaxAfterShipPackaging" value="<%=aascCarrierProfileOptionsInfo.getPackaging()%>"/>
                <%
                    } 
                    else
                    { 
                %>
                <option value="<%=aascShipmentHeaderInfo.getPackaging()%>"> <%=aascShipmentHeaderInfo.getPackaging()%> </option>
                <input type="hidden" name="ajaxAfterShipPackaging" id="ajaxAfterShipPackaging" value="<%=aascShipmentHeaderInfo.getPackaging()%>"/>
                <%
                    }
                %>
                </select>
              </td>
              </tr>
              <tr>
              <td align="left" valign="top" class="dispalyFields" width="15%"> <s:property value="getText('CarrierPayMethod')"/></td>
              <td align="left" valign="top" width="30%"> <span class="style7">
              <%
                logger.info("###*****carrierPayMethod****###"+aascShipmentHeaderInfo.getCarrierPaymentMethod());
              %>
              <select name="carrierPayMethod" id="carrierPayMethodId" size="1" class="inputFields" onchange="chgCarrierPayMethod();autoCarrierACNumber();tpNullValue();getAccountNumber()" <%=ShipmentFlags.getSelectDisableFlag()%> >>
              <% 
                String localCarrierCode="";
                String payTerm = "" ; 
                try
                {

                  while(carrierPayMethodIterator.hasNext())
                  {
                  aascShipMethodInfo=(AascShipMethodInfo)carrierPayMethodIterator.next();
                  logger.info("carrierPayCode= "+aascShipMethodInfo.getCarrierPayCode() +"  carrierPaymentTerms= "+aascShipMethodInfo.getCarrierPaymentTerms());
                    if((aascCarrierProfileOptionsInfo!=null)&&(aascShipmentHeaderInfo.getShipFlag()).equalsIgnoreCase("N"))
                    {
                      ////logger.info("Inside if");
                      if(aascCarrierProfileOptionsInfo.getCarrierPaymentTerms().equals(aascShipMethodInfo.getCarrierPaymentTerms()))
                      {
                      localCarrierCode=aascShipMethodInfo.getCarrierPayCode();
                      payTerm = aascCarrierProfileOptionsInfo.getCarrierPaymentTerms();
                  %>
                     <option value="<%=localCarrierCode%>" selected="selected"> <%=aascCarrierProfileOptionsInfo.getCarrierPaymentTerms()%> </option>
                  <%
                      }
                    }
                    else
                    {
                       ////logger.info("Inside Else");
                       if(aascShipmentHeaderInfo.getCarrierPaymentMethod().equals( aascShipMethodInfo.getCarrierPaymentTerms()))
                       {
                         // //logger.info("Inside ElseIf localCarrierCode  ::"+localCarrierCode);
                         localCarrierCode=aascShipMethodInfo.getCarrierPayCode();
                         payTerm = aascShipMethodInfo.getCarrierPaymentTerms() ;
                  %>
                     <option value="<%=localCarrierCode%>"><%= aascShipMethodInfo.getCarrierPaymentTerms()%>  </option>
                  <%
                          break;
                        }
                      }
                    }
                    // //logger.info("outside the try block localCarrierCode   ::"+localCarrierCode);
                  %>
                  <option value="<%=localCarrierCode%>"> <%= aascShipMethodInfo.getCarrierPaymentTerms()%> </option>
                  <%
                  }
                catch(Exception e)
                {
                  logger.severe("exception while creating the carrierPayMethod"+e.getMessage());
                  e.printStackTrace();
                  response.sendRedirect(url+"/aascShipError.jsp");
                }
              %>
              </select>
              <input type="hidden"  name="ajaxAfterShipCarrPayMthdValue"  id="ajaxAfterShipCarrPayMthdValue"  value="<%=localCarrierCode%>"/>
              <input type="hidden"  name="ajaxAfterShipCarrPayMthdStrValue"  id="ajaxAfterShipCarrPayMthdStrValue"  value="<%=payTerm%>"/>
              <!-- <input name="tpPopup" type="button" class="heref" onClick="tpOpenWin()" value="More . . ."  <%=ShipmentFlags.getTpDisable()%>/> -->
              <s:if test='%{#aascShipmentHeaderInfo.shipFlag == "Y" || #aascShipmentHeaderInfo.shipFlag == "y"}'>
                <s:a href="javascript:tpOpenWin()"> <img src="buttons/aascMoreOff1.png" name="tpPopup" id="tpPopupId" border="0"></img> </s:a> </s:if>
              <s:else><s:a href="javascript:tpOpenWin()"> <img src="buttons/aascMore1.png" name="tpPopup" id="tpPopupId" border="0"></img> </s:a> </s:else>
              </span>
              </td>
              <s:hidden name="acctPostalCode" id="acctPostalCode" value="%{#aascShipmentHeaderInfo.acctPostalCode}"/>
              <s:hidden name="countryCodeVal" id="countryCodeVal" value="%{#aascShipmentHeaderInfo.tpCountrySymbol}"/>
              <s:hidden name="tpCompanyName" id="tpCompanyNameID" value="%{#aascShipmentHeaderInfo.tpCompanyName}"/>
              <s:hidden name="tpAddress" id="tpAddressID" value="%{#aascShipmentHeaderInfo.tpAddress}"/>
              <s:hidden name="tpState" id="tpStateID" value="%{#aascShipmentHeaderInfo.tpState}"/>
              <s:hidden name="tpCity" id="tpCityID" value="%{#aascShipmentHeaderInfo.tpCity}"/>
              <s:hidden name="tpPostalCode" id="tpPostalCodeID" value="%{#aascShipmentHeaderInfo.tpPostalCode}"/>
              <s:hidden name="tpCountrySymbol" id="tpCountrySymbolID" value="%{#aascShipmentHeaderInfo.tpCountrySymbol}"/>
              </tr>
              <tr>
                <td align="left" valign="middle" class="dispalyFields" width="15%"> <s:property value="getText('CarrierA/CNumber')"/> </td>
                <td align="left" valign="top" width="30%"> <span class="style7">
                    <s:textfield name="carrierAccountNumber"  id="carrierAccountNumberId"  value="%{#aascShipmentHeaderInfo.carrierAccountNumber}" cssClass="inputFields" maxlength="30"  readonly="%{#attr.readOnlyFlag}"/>
                  </span>
                </td>
                <s:hidden name="ajaxAfterShipCarrAccNumber"  id="ajaxAfterShipCarrAccNumber"  value="%{#aascShipmentHeaderInfo.carrierAccountNumber}"/>
              </tr>
              <tr>
                <td align="left" valign="middle" class="dispalyFields" width="15%"> <s:property value="getText('SaturdayShipmentDelivery')"/> ? 
                  <% 
                    String SaturdayCheckBoxValue="";
                    if(aascShipmentHeaderInfo.getSaturdayShipFlag().equalsIgnoreCase("Y")){
                      SaturdayCheckBoxValue="checked"; }
                    logger.info("SaturdayCheckBoxValue : "+SaturdayCheckBoxValue);   
                  %>
                </td>
                <td align="left" valign="top" width="30%"> <input name="saturdayShipFlag" type="checkbox" id="chkSatShipment123" value="<%=(aascShipmentHeaderInfo.getSaturdayShipFlag())%>" <%=SaturdayCheckBoxValue%>  onClick="chkSatShip();" >
                  <input type="HIDDEN" name="chkSatShipmentHidden" id="chkSatShipmentHidden"/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="middle" class="dispalyFields"  width="15%"> <s:property value="getText('ShipmentDate')"/>  ( yyyy-mm-dd) </td>
                <td align="left" valign="top" width="30%"> <span class="style7">
                    <input name="shipmentDateID" id="shipmentDateID" type="text" value="<%=nullStringToSpace(aascShipmentHeaderInfo.getShipmentDate())%>" class="inputFields" maxlength="10"  readonly="readonly"/>
                  </span> &nbsp; <a href="javascript:NewCssCal('shipmentDateID','yyyyMMdd','DropDown',false,24,false);"> <img src="images/cal.gif" id="calId" width="16" height="16" border="0" alt="Pick a date"></img> </a> </td>
              </tr>
              <tr>
                <td align="left" valign="middle" class="dispalyFields"  width="15%">
                  <s:property value="getText('Reference#1')"/>
                </td>
                <td align="left" valign="top" width="30%">
                  <span class="style7">
                    <s:textfield name="reference1"  cssClass="inputFields"  id="reference1" value="%{#aascShipmentHeaderInfo.reference1}" size="20" maxlength="45"  readonly="%{#attr.readOnlyFlag}"/>
                  </span>
                </td>
              </tr>
              <tr>
                <td align="left" valign="middle" class="dispalyFields" width="15%">
                  <s:property value="getText('Reference#2')"/>
                </td>
                <td align="left" valign="top" width="30%">
                  <span class="style7">
                    <s:textfield name="reference2"  value="%{#aascShipmentHeaderInfo.reference2}" cssClass="inputFields" id="reference2" size="20" maxlength="12"  readonly="%{#attr.readOnlyFlag}"/>
                  </span>
                </td>
              </tr>
            </table>  <!--service table end-->
          </td>
          <td valign="top">
          <table width="60%" align="left">
            <tr>
              <td height="134" width="55%" style="border: 0px; border-collapse: collapse;"  valign="top">
                <jsp:include page="/aascShipmentPackageDetails.jsp">
                  <jsp:param name="ShipmentFlags" value="<%=ShipmentFlags%>"/>
                  <jsp:param name="aascShipmentHeaderInfo" value="<%=aascShipmentHeaderInfo%>"/>
                  <jsp:param name="shipReadonlyFlag" value='<%=nullStringToSpace(ShipmentFlags.getShipReadonlyFlag())%>'/>
                  <jsp:param name="flagUPSReadonly" value='<%=nullStringToSpace(ShipmentFlags.getFlagUPSReadonly())%>'/>
                  <jsp:param name="aascCarrierProfileOptionsInfo" value='<%=nullStringToSpace(aascCarrierProfileOptionsInfo)%>'/>
                </jsp:include>
              </td>
            </tr>
       
          <% }
          catch(Exception e)
          {
           logger.severe("exception in the Shipment form "+e.getMessage());
           e.printStackTrace();
          }
          %>
          </table>  <!-- end of package td -->
          </td>
        </tr>
        </table>
      </td>
    </tr>  <!-- end of services and packages -->
  </table>
  <%@ include file="aascFooter.jsp"%>
  </div>
          
  </body>
</html>
